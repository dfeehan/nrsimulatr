<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore expected values for stochastic block-model simulations â€¢ nrsimulatr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Explore expected values for stochastic block-model simulations">
<meta property="og:description" content="nrsimulatr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-EG7VL6DQ9E"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EG7VL6DQ9E');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nrsimulatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2.902</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/dfeehan/nrsimulatr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sbm-expectedvalues_files/header-attrs-2.5/header-attrs.js"></script><link href="sbm-expectedvalues_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="sbm-expectedvalues_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Explore expected values for stochastic block-model simulations</h1>
                        <h4 class="author"></h4>
            
            <h4 class="date">2020-11-08</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/dfeehan/nrsimulatr/blob/master/vignettes/sbm-expectedvalues.Rmd"><code>vignettes/sbm-expectedvalues.Rmd</code></a></small>
      <div class="hidden name"><code>sbm-expectedvalues.Rmd</code></div>

    </div>

    
    
<pre><code>## Warning: replacing previous import 'dplyr::union' by 'igraph::union' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::as_data_frame' by
## 'igraph::as_data_frame' when loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::groups' by 'igraph::groups' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::failwith' by 'plyr::failwith' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::id' by 'plyr::id' when loading
## 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::summarize' by 'plyr::summarize' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::count' by 'plyr::count' when loading
## 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::desc' by 'plyr::desc' when loading
## 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::mutate' by 'plyr::mutate' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::arrange' by 'plyr::arrange' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::rename' by 'plyr::rename' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'dplyr::summarise' by 'plyr::summarise' when
## loading 'nrsimulatr'</code></pre>
<pre><code>## Warning: replacing previous import 'igraph::crossing' by 'tidyr::crossing' when
## loading 'nrsimulatr'</code></pre>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>This file shows the (analytically-derived) expected values for several quantities under the stochastic block model simulation design. There are three variants of the design: simple, nested, and two-parameter. These can be distinguished by the mixing matrices, as shown below.</p>
<div id="simple-mixing-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#simple-mixing-matrix" class="anchor"></a>Simple mixing matrix</h4>
<p>In the simple mixing matrix, the probability of a tie between any two vertices that are not in exactly the same group is multiplied by <span class="math inline">\(\rho\)</span>:</p>
<p><span class="math display">\[
\begin{matrix}
    &amp; ~F~H           &amp; ~F \lnot H     &amp; \lnot F ~H     &amp; \lnot F \lnot H \\
    ~F~H            &amp; \zeta           &amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta \\
    ~F \lnot H      &amp; \rho\cdot\zeta  &amp; \zeta           &amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta \\
    \lnot F ~H      &amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta  &amp; \zeta           &amp; \rho\cdot\zeta \\
    \lnot F \lnot H &amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta  &amp; \zeta
\end{matrix}
\]</span></p>
</div>
<div id="nested-mixing-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#nested-mixing-matrix" class="anchor"></a>Nested mixing matrix</h4>
<p>In the nested mixing matrix, the probability of a tie between any two vertices who differ in one dimension (membership in <span class="math inline">\(F\)</span> or membership in <span class="math inline">\(H\)</span>) is multiplied by <span class="math inline">\(\rho\)</span>; the probability of a tie between two vertices that differ on both dimensions is multiplied by <span class="math inline">\(\rho^2\)</span>:</p>
<p><span class="math display">\[
\begin{matrix}
    &amp; ~F~H           &amp; ~F \lnot H     &amp; \lnot F ~H     &amp; \lnot F \lnot H \\
    ~F~H            &amp; \zeta           &amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta  &amp; \rho^2\cdot\zeta \\
    ~F \lnot H      &amp; \rho\cdot\zeta  &amp; \zeta           &amp; \rho^2\cdot\zeta&amp; \rho\cdot\zeta \\
    \lnot F ~H      &amp; \rho\cdot\zeta  &amp; \rho^2\cdot\zeta&amp; \zeta           &amp; \rho\cdot\zeta \\
    \lnot F \lnot H &amp; \rho^2\cdot\zeta&amp; \rho\cdot\zeta  &amp; \rho\cdot\zeta  &amp; \zeta
\end{matrix}
\]</span></p>
</div>
<div id="two-parameter-mixing-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#two-parameter-mixing-matrix" class="anchor"></a>Two-parameter mixing matrix</h4>
<p>In the two-parameter mixing matrix, the probability of a tie between two vertices that differ in membership in <span class="math inline">\(F\)</span> is multiplied by <span class="math inline">\(\xi\)</span>; and, independently, the probability of a tie between two vertices that differ in membership in <span class="math inline">\(H\)</span> is multiplied by <span class="math inline">\(\rho\)</span>:</p>
<p><span class="math display">\[
\begin{matrix}
                    &amp; ~F~H                   &amp; ~F \lnot H              &amp; \lnot F ~H              &amp; \lnot F \lnot H \\
    ~F~H            &amp; \zeta                  &amp; \rho\cdot\zeta          &amp; \xi\cdot\zeta           &amp; \xi\cdot\rho\cdot\zeta \\
    ~F \lnot H      &amp; \rho\cdot\zeta         &amp; \zeta                   &amp; \xi\cdot\rho\cdot\zeta  &amp; \xi\cdot\zeta \\
    \lnot F ~H      &amp; \xi\cdot\zeta          &amp; \xi\cdot\rho\cdot\zeta  &amp; \zeta                   &amp; \rho\cdot\zeta \\
    \lnot F \lnot H &amp; \xi\cdot\rho\cdot\zeta &amp; \xi\cdot\zeta           &amp; \rho\cdot\zeta          &amp; \zeta
\end{matrix}
\]</span></p>
</div>
<div id="analytical-derivations" class="section level3">
<h3 class="hasAnchor">
<a href="#analytical-derivations" class="anchor"></a>Analytical derivations</h3>
<p>The expected values for the number of connections between groups or sets of groups depends on the structure of the mixing matrix. Write the number of vertices in each of the four blocks as a vector, <span class="math inline">\(\mathbf{n}\)</span>.</p>
<p>Suppose we wish to count the number of expected connections from a set <span class="math inline">\(A\)</span> to another set <span class="math inline">\(B\)</span>, with both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> built up from one or more of the four blocks. Let <span class="math inline">\(\mathbf{a}\)</span> be the 0/1 vector that indicates which blocks <span class="math inline">\(A\)</span> contains, and <span class="math inline">\(\mathbf{b}\)</span> be the 0/1 vector that indicates which blocks <span class="math inline">\(B\)</span> contains. The size of A is then <span class="math inline">\(N_A = \mathbf{a}^T \mathbf{n}\)</span>.</p>
<p>Let <span class="math inline">\(\mathbf{a}_N = \mathbf{a} * \mathbf{n}\)</span>, where <span class="math inline">\(*\)</span> denotes element-wise multiplication. Then</p>
<p><span class="math display">\[
\begin{equation}
d_{A,B} = \mathbf{a}_N^T ~M~ \mathbf{b}_N - 
          (\mathbf{a} * \mathbf{b} * \mathbf{n})^T \text{diag}(M).
\end{equation}
\]</span></p>
<p>To understand this expression, note that the number of edges between two distinct blocks <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> will be <span class="math inline">\(N_i~N_j~M_{ij}\)</span>. Since we do not permit self-loops, the number of edges from one block to itself will be <span class="math inline">\(\frac{N_i~(N_i - 1)}{2}~M_{ii}\)</span>. The expression</p>
<p><span class="math display">\[
\begin{equation}
\mathbf{a}_N^T~M~\mathbf{b}_N = \sum_{i \in b(A)} \sum_{j \in b(B)} N_i~N_j~M_{ij}
\end{equation}
\]</span> where <span class="math inline">\(b(A)\)</span> and <span class="math inline">\(b(B)\)</span> are the sets of blocks consisting of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is almost what we want. The problem is that each block <span class="math inline">\(i\)</span> in both <span class="math inline">\(b(A)\)</span> and <span class="math inline">\(b(B)\)</span> is sending edges to itself. In the equation above, it contributes <span class="math inline">\(N_i^2~M_{i,i}\)</span> instead of <span class="math inline">\(\frac{N_i~(N_i - 1)}{2}~M_{i,i}\)</span>. So instead of the equation above, we actually want</p>
<p><span class="math display">\[
\begin{equation}
d_{A, B} = \sum_{i \in b(A)} \sum_{j \in b(B)} N_i~N_j~M_{ij} -
   \sum_{i \in b(A) \cap b(B)} \frac{(N_i^2 + N_i)}{2}~M_{i,i},
\end{equation}
\]</span></p>
<p>In this equation, the subtracted term accounts for the difference between <span class="math inline">\(N_i^2\)</span> and <span class="math inline">\(\frac{N_i~(N_i - 1)}{2}\)</span>.</p>
<!--TODO - also show expression for variance of expected values-->
</div>
</div>
<div id="illustration" class="section level2">
<h2 class="hasAnchor">
<a href="#illustration" class="anchor"></a>Illustration</h2>
<p>Next, we will look at the expected values for several important quantities under all of the versions of the stochastic block-model.</p>
<div id="expected-values-for-adjustment-factors" class="section level3">
<h3 class="hasAnchor">
<a href="#expected-values-for-adjustment-factors" class="anchor"></a>Expected values for adjustment factors</h3>
<p>First weâ€™ll look at these holding <span class="math inline">\(\xi\)</span> fixed at 0.6 (which only affects the twoparam model):</p>
<p><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>Next weâ€™ll look at these holding <span class="math inline">\(\rho\)</span> fixed at 0.6 (which only affects the twoparam model):</p>
<p><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div id="bias" class="section level3">
<h3 class="hasAnchor">
<a href="#bias" class="anchor"></a>Bias</h3>
<div id="two-parameter-model" class="section level4">
<h4 class="hasAnchor">
<a href="#two-parameter-model" class="anchor"></a>Two parameter model</h4>
<p>These plots show the bias in three different scale-up estimators under the two-parameter model when <span class="math inline">\(\tau=1\)</span>.</p>
<p><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
</div>
<div id="basic-scale-up-estimator-expected-values" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-scale-up-estimator-expected-values" class="anchor"></a>Basic scale-up estimator expected values</h3>
<p><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
</div>
<div id="adapted-scale-up-estimator-expected-values" class="section level3">
<h3 class="hasAnchor">
<a href="#adapted-scale-up-estimator-expected-values" class="anchor"></a>Adapted scale-up estimator expected values</h3>
<p><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</div>
<div id="generalized-scale-up-estimator-expected-values" class="section level3">
<h3 class="hasAnchor">
<a href="#generalized-scale-up-estimator-expected-values" class="anchor"></a>Generalized scale-up estimator expected values</h3>
<p><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
</div>
<div id="scenario-two-parameter-model" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-two-parameter-model" class="anchor"></a>Scenario: Two-parameter model</h2>
<p>Now we look at a specific scenario for just the two-parameter model.</p>
<p><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-14-1.png" width="1152"><img src="sbm-expectedvalues_files/figure-html/unnamed-chunk-14-2.png" width="1152"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dennis Feehan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
